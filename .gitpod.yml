# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/config-gitpod-file)
# and commit this file to your remote git repository to share the goodness with others.
github:
  prebuilds:
    # enable for the master/default branch (defaults to true)
    master: true
    # enable for all branches in this repo (defaults to false)
    branches: false
    # enable for pull requests coming from this repo (defaults to true)
    pullRequests: true
    # add a check to pull requests (defaults to true)
    addCheck: true
    # add a "Review in Gitpod" button as a comment to pull requests (defaults to false)
    addComment: false

image:
  file: .gitpod.dockerfile

ports:
  - port: 3000
    onOpen: ignore
  - port: 6379
    onOpen: ignore
  - port: 8000
    onOpen: ignore

tasks:
  - command: sudo apt-get update -y  &&  sudo apt-get install python3-dev libpq-dev libxml2-dev libxslt1-dev libldap2-dev libsasl2-dev libffi-dev -y && cd spug_api/ && pip install --user -r requirements.txt && python3 manage.py updatedb && python3 manage.py user add -u admin -p spug.dev -s -n 管理员 && python3 manage.py runserver
  - command: cd spug_web/ && nvm install 12 && nvm use 12 && npm install --registry=https://registry.npm.taobao.org && npm start
  - command: redis-server